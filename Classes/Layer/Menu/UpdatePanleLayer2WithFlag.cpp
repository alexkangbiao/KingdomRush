#include "UpdatePanleLayer2WithFlag.h"#include "GameManager.h"#include "BaseBuildIcon.h"#include "TouchLayer.h"#include "BaseMap.h"USING_NS_CC;UpdatePanleLayer2WithFlag* UpdatePanleLayer2WithFlag::createPanle(int icon1,int icon2,int money1,int money2){    auto updatePanleLayer2WithFlag = new UpdatePanleLayer2WithFlag();     if (updatePanleLayer2WithFlag && updatePanleLayer2WithFlag->initWithIcons(icon1,icon2,money1,money2))    {        updatePanleLayer2WithFlag->autorelease();        return updatePanleLayer2WithFlag;    }    CC_SAFE_DELETE(updatePanleLayer2WithFlag);    return NULL;}bool UpdatePanleLayer2WithFlag::initWithIcons(int icon1, int icon2, int money1, int money2){    if ( ! UpdatePanelLayer2::initWithIcons(icon1, icon2, money1, money2) )    {        return false;    }    return true;}void UpdatePanleLayer2WithFlag::addOthersIcons(){    _flag = Sprite::createWithSpriteFrameName("sub_icons_0001.png");    _flag->setPosition(Point(_ringBackgroundSprite->getContentSize().width / 4 + _flag->getContentSize().width / 2 ,                             - _ringBackgroundSprite->getContentSize().height / 3.2));    _flag->setVisible(false);    this->addChild(_flag, PanelLayerDrawingOrderIcon);        _flag->setVisible(true);        auto flagListener = EventListenerTouchOneByOne::create();    flagListener->onTouchBegan = CC_CALLBACK_2(UpdatePanleLayer2WithFlag::onFlagTouchBegan, this);    flagListener->onTouchEnded = CC_CALLBACK_2(UpdatePanleLayer2WithFlag::onFlagTouchEnded, this);    flagListener->setSwallowTouches(true);    _eventDispatcher->addEventListenerWithSceneGraphPriority(flagListener, _flag);}bool UpdatePanleLayer2WithFlag::onFlagTouchBegan(Touch *touch, Event *event){    auto target = static_cast<Sprite*>(event->getCurrentTarget());        Point locationInNode = target->convertTouchToNodeSpace(touch);        Size size = target->getContentSize();    Rect rect = Rect(0, 0, size.width, size.height);    if (rect.containsPoint(locationInNode))    {        return true;    }    return false;}void UpdatePanleLayer2WithFlag::onFlagTouchEnded(Touch* touch, Event* event){    static_cast<TouchLayer*>(this->getParent())->setTower(this->getTower());    static_cast<TouchLayer*>(this->getParent())->setRallyFlagTouchShield();        tower->_isUpdateMenuShown = false;    this->removeFromParent();}