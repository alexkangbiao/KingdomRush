#include "GameViewMenu.h"#include "GameManager.h"#include "UpgradeScene.h"#include "ShopScene.h"#include "SoundManager.h"#include "EncyclopediaScene.h"#include "Utility.h"bool GameViewMenu::init(){    if ( !Layer::init() )    {        return false;    }	_isFirst = true;    this->addMenuItems();    this->addMapStarContainer();	return true;}void GameViewMenu::addMapStarContainer() {    auto visiableSize = Director::getInstance()->getVisibleSize();    _mapStarsContainer = Sprite::createWithSpriteFrameName("mapStarsContainer.png");    _mapStarsContainer->setPosition(Point(visiableSize.width - _mapStarsContainer->getContentSize().width / 2 - 10 ,                                          visiableSize.height - _mapStarsContainer->getContentSize().height / 2 + 60));    this->addChild(_mapStarsContainer);        _starLabel = Label::createWithBMFont("fonts/bmfont.fnt", "0");//createWithTTF("0","fonts/SohoGothicProMedium.ttf", 26);    _starLabel->setPosition(Point(_mapStarsContainer->getContentSize().width/4*3+20,                                 _mapStarsContainer->getContentSize().height/2));    _mapStarsContainer->addChild(_starLabel);        _diamondsLabel = Label::createWithBMFont("fonts/bmfont.fnt", "0");//createWithTTF("0","fonts/SohoGothicProMedium.ttf", 26);    _diamondsLabel->setPosition(Point(_mapStarsContainer->getContentSize().width / 4,                                     _mapStarsContainer->getContentSize().height / 2));    _mapStarsContainer->addChild(_diamondsLabel);}void GameViewMenu::addMenuItems() {    auto visiableSize = Director::getInstance()->getVisibleSize();    _shopMenuItem = MenuItemSprite::create(Sprite::createWithSpriteFrameName("butShop_0001.png"),                                          Sprite::createWithSpriteFrameName("butShop_0002.png"),                                          CC_CALLBACK_1(GameViewMenu::onTouchShopMenuItem, this));    _updateMenuItem = MenuItemSprite::create(Sprite::createWithSpriteFrameName("butUpgrades_0001.png"),                                            Sprite::createWithSpriteFrameName("butUpgrades_0002.png"),                                            CC_CALLBACK_1(GameViewMenu::onTouchUpdateMenuItem, this));    _bookMenuItem = MenuItemSprite::create(Sprite::createWithSpriteFrameName("butEncyclopedia_0001.png"),                                          Sprite::createWithSpriteFrameName("butEncyclopedia_0002.png"),                                          CC_CALLBACK_1(GameViewMenu::onTouchBookMenuItem, this));        _bookMenuItem->setPosition(Point(visiableSize.width - _bookMenuItem->getContentSize().width / 2,                                    _bookMenuItem->getContentSize().height/2 - 130));    _updateMenuItem->setPosition(Point(_bookMenuItem->getPosition().x - 160,                                      _updateMenuItem->getContentSize().height/2 - 130));    _shopMenuItem->setPosition(Point(_updateMenuItem->getPosition().x - 160,                                    _shopMenuItem->getContentSize().height/2 - 130));        auto menu = Menu::create(_shopMenuItem, _updateMenuItem, _bookMenuItem, NULL);    menu->setPosition(Vec2::ZERO);    this->addChild(menu);}void GameViewMenu::onEnterTransitionDidFinish(){	auto instance = GameManager::getInstance();    	_starLabel->setString(                Utility::string_format("%d/65",                                         UserDefault::getInstance()->getIntegerForKey(                                                    instance->SLOT_X_STAR_NUMBER_SUM, 0)));	_diamondsLabel->setString(                Utility::string_format("%d",                                         UserDefault::getInstance()->getIntegerForKey(                                                    instance->SLOTX_DIAMOND_NUMBER, 0)));	    if (_isFirst) {		_bookMenuItem->runAction(MoveBy::create(0.3f, Point(0, 130)));		_updateMenuItem->runAction(MoveBy::create(0.3f, Point(0, 130)));		_shopMenuItem->runAction(MoveBy::create(0.3f, Point(0, 130)));		_mapStarsContainer->runAction(MoveBy::create(0.3f, Point(0, -70)));		_isFirst = false;	}}void GameViewMenu::onTouchBookMenuItem(Ref *pSender) {    SoundManager::playClickEffect();    Director::getInstance()->getInstance()->pushScene(EncyclopediaScene::createScene());}void GameViewMenu::onTouchShopMenuItem(Ref *pSender) {    SoundManager::playClickEffect();    Director::getInstance()->getInstance()->pushScene(ShopScene::createScene());}void GameViewMenu::onTouchUpdateMenuItem(Ref *pSender) {    SoundManager::playClickEffect();    Director::getInstance()->getInstance()->pushScene(UpgradeScene::createScene());}